title: View
extends@: default

form:
  fields:
    tabs:
      type: tabs
      active: 1
      fields:
        content:
          type: tab
          fields:
            # automatically added to when view is saved
            shortcodes_section:
              type: fieldset
              title: View Popup Button Shortcodes
              ordering@: header.title
              text: "This is a list of shortcodes for all features added to the view. Copy and paste these codes into your content to manually add the view popup buttons where you want them. (Ignore this if you are using List View Popup Buttons). The text inside the shortcode (the feature name) does not affect anything. It is purely for your convenience when reading your content and can be removed or modified as desired. If you add or remove features from the view features list, please save the page to update this list."
              collapsed: true
              collapsible: true
              fields:
                header.shortcodes_list:
                  type: textarea
                  readonly: true
                  rows: 12
                  style: vertical
                  default: 'There is nothing here. Add some features to the view first.'

        view: # new tab
          type: tab
          title: View
          ordering@: content
          fields:

            header.start_section:
              type: section
              title: Starting Position
              text: By default, the starting bounds will be determined by all included features. You can override this by providing bounds manually in the page header (expert mode) or by choosing a center and a distance (in degrees) from it. You can choose a location for the center or set the latitude and longitude manually.
              underline: true
            
            # should provide list of all points included in datasets in the tour (even if some of those points will not be shown in the public-facing tour)
            header.start.location:
              type: select
              label: Central Location
              data-options@: 'Grav\Plugin\LeafletTourPlugin::getTourLocationsForView'
            # TODO: note units
            header.start.long:
              type: number
              label: Center Longitude
              validate:
                min: -180
                max: 180
                step: .0000001
            # TODO: note units
            header.start.lat:
              type: number
              label: Center Latitude
              validate:
                min: -90
                max: 90
                step: .0000001
            # TODO: Note units
            header.start.distance:
              type: number
              label: Distance from Starting Center
              size: long
              validate:
                min: 0
                step: .0000001
            
            header.features_set:
              type: fieldset
              title: Features
              icon: map-marker
              collapsed: true
              collapsible: true
              fields:
                # TODO: Describe which features are available?
                header.features:
                  type: list
                  label: Feature List
                  description: A list of all locations/features included in the view.
                  style: vertical
                  btnLabel: Add Feature
                  controls: both
                  fields:
                    .id:
                      type: select
                      label: Feature
                      data-options@: 'Grav\Plugin\LeafletTourPlugin::getTourFeaturesForView'
                      validate:
                        required: true
            
            header.advanced_set:
              type: fieldset
              title: Advanced
              icon: cog
              collapsed: true
              collapsible: true
              fields:
                
                header.only_show_view_features:
                  type: toggle
                  toggleable: true
                  label: Only Show Current View Features
                  description: "If toggled, when in this view only the features provided in the Feature List (above) will be shown on the map. Overrides the tour setting."
                  highlight: 1
                  default: 0
                  options:
                    1: PLUGIN_ADMIN.ENABLED
                    0: PLUGIN_ADMIN.DISABLED
                  validate:
                    type: bool
                
                header.remove_tile_server:
                  type: toggle
                  toggleable: true
                  label: Remove Tile Server
                  description: If toggled, will remove the tile server when a custom basemap is currently in use. This will save loading time, but may look odd if the custom basemap does not cover sufficient area. Overrides the tour setting.
                  highlight: 1
                  default: 1
                  options:
                    1: PLUGIN_ADMIN.ENABLED
                    0: PLUGIN_ADMIN.DISABLED
                  validate:
                    type: bool
                
                header.no_tour_basemaps:
                  type: toggle
                  label: Hide Tour Basemaps
                  description: By default, both basemaps set in the tour configuration and basemaps set in the view configuration will be shown in the view. Check this option to only show basemaps from the view configuration.
                  highlight: 1
                  default: 0
                  options:
                    1: PLUGIN_ADMIN.ENABLED
                    0: PLUGIN_ADMIN.DISABLED
                  validate:
                    type: bool
                # TODO: Note that basemap settings are in plugin config?
                header.basemaps:
                  type: list
                  label: Additional Basemap Images
                  style: vertical
                  btnLabel: Add Basemap
                  fields:
                    .file:
                      type: select
                      label: Select the basemap
                      data-options@: 'Grav\Plugin\LeafletTourPlugin::getBasemaps'
                      validate:
                        required: true
                # TODO: Refer to fuller description?
                header.list_popup_buttons:
                  type: toggle
                  toggleable: true
                  label: List View Popup Buttons
                  description: Buttons to go to all view feature popups will be added at the end of each view. Uncheck this option if you are going to manually determine where the buttons will be located using shortcodes. Overrides the tour setting.
                  highlight: 1
                  default: 1
                  options:
                    1: PLUGIN_ADMIN.ENABLED
                    0: PLUGIN_ADMIN.DISABLED
                  validate:
                    type: bool